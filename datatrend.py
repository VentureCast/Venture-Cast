import pandas as pd
import numpy as np
from io import StringIO

# Full dataset as string
data_str = """id	count	price
0080c650-c544-4d1c-b6e0-8ed1333a4cd5	1527310	3.67
017ba2ce-9d2d-4915-8a72-8b5843519a09	572545	4.25
05728538-0fc8-4f6f-9c29-a07391bca5ea	4382636	2.98
05a0daf2-0eec-49af-b2cb-b52ce150597d	1513559	4.25
141477ec-18f4-403e-9628-7b8b929d8402	730050	3.67
14fba716-f23b-44e0-a545-ef93065a538d	1650369	4.25
1712ab45-689c-4754-b45f-db30b858ca8f	1800225	5.02
179df0c6-8c9c-4b65-bc61-8c742ea6501c	1455309	2.98
1885e6ef-5626-46b7-8cd8-e401e3e01000	533602	3.94
223b0a1e-d9da-4002-9774-8c721912f9cf	880275	5.02
23041034-bde8-4c03-b2b7-6f191ae28669	3782722	3.67
24c1d771-67f3-47d3-a594-10ff476e16bf	8270942	4.25
28921221-489b-4207-888d-1b6b5542c102	1269792	2.98
2ad2fe8e-b66f-49aa-99e9-55875926f8eb	694424	3.67
2b1e9737-4c52-499a-a113-155d55eba134	1682072	3.67
2ba3135a-f3db-417d-954c-fc9b8285b682	1990595	4.25
2fd24193-43b6-49a0-8070-51f2e3128833	1986303	5.02
30518ce9-740c-4de9-af4d-910bc4f28477	2787877	3.67
31662a43-0e6f-47f8-af12-79c009ddd104	536103	2.98
3f1aed38-906b-423a-a79e-81aab214adba	32907	3.67
3f6d5aeb-ae47-4ac3-901c-71d45df49696	1355980	5.02
41fada6a-e2b2-42b2-a9a3-c61f68106818	1964478	3.67
42c19837-2cad-431d-bbaa-b549044290ea	1505942	2.98
481856d2-c62d-4c50-ad16-645d8463bd75	6321781	4.25
49fec7b9-404f-4386-aa32-8368247241de	2091396	5.02
4c4492f3-b5b7-45c7-bfd2-64460d866ec5	3282976	3.67
4c7efd91-c596-4c62-bb09-0c0ed7281027	722425	4.25
4fde0576-d1ff-4a49-a1a4-46509c99a8d4	1077670	2.98
5f2fbaf9-be33-4316-a49d-74b35162fda9	3433269	4.25
62e86dbc-3171-411b-a7cd-1196382e36b1	2325703	2.98
641e3e2b-219a-4291-90d6-7b5224964051	1405850	4.25
6434e1ee-e6bd-41b2-b490-46d70fa976ea	4544541	5.02
6534f62a-2d62-4dea-9737-0eb0bf1d406b	1755484	4.25
66880a5d-5152-4b10-aa8f-9f5ef061fe7c	5964	3.67
66bc6d8d-db0b-4f08-9f88-d73092d2c2f3	1851598	4.25
67371a5c-5d4b-48b5-b542-db6296d6fe34	677342	2.98
69aa6808-0419-4b83-a9c9-c6a5e116ca20	922461	3.67
6a35c604-f333-433e-853d-b2b92b5b2e79	835195	4.25
6e3bd315-ea7d-40d3-a0fe-0dd0f0d9dfce	7251359	5.02
712bf676-6605-4512-8f68-d3372296137d	1765942	3.67
7591b6e4-441f-4b98-811e-6f1737648f6f	895343	2.98
7b4296ab-6f23-4426-a999-35645bb4db33	7227283	4.25
7c83e37c-232f-4ad2-9007-3d1cb6ba81fc	12066025	3.67
7d3ee495-a0e0-4eb4-b8d5-f77641740797	6671259	2.98
7fb4efa0-911d-4d82-bc99-ff943f8634aa	873104	3.67
7ff89e7d-d929-4ac7-afe0-a28b0f50bfa3	2208081	4.25
80347b19-8e65-472b-8b8c-380cb74455d5	4388058	2.98
89d7a478-a108-4e91-a13e-0280675a0a79	1881234	3.67
8a0203f7-f07f-41d7-b14d-dc9e91ae41a3	18058121	5.02
8da61524-52b2-417f-aa43-6b439f3af024	863961	3.67
8dd85f9e-18f3-4e22-8ecd-9070ec40bf04	1286659	2.98
8fab5777-9bfa-4120-a160-905ab4aa51d8	1667642	3.01
9551ef80-47e8-4f0b-ac8e-92666678de18	11130660	3.67
975bc8c9-08f1-41e9-a6a2-14a7efa65d3b	2180766	2.98
97b9ad57-5df0-4e20-b2c6-58bc54eec7ae	9383425	5.02
98235cd0-e002-45fe-91cc-2656d31b2532	1208706	4.25
9ae85a32-f24b-42cc-a6bd-11c02611b736	1861640	3.67
9bc8a428-4be7-4bbd-a03d-1494ddd2b6e6	634966	5.02
9e2f64a0-3764-42f3-b1b3-ff571c08ec06	758030	3.67
9efa1798-c6fd-4838-a906-25d2d6a810e7	1337291	5.02
a107f94f-e13a-4b8f-b3c5-5cdacc2751f6	19193084	3.67
a1702ef9-65d1-487d-a90d-f1527821fbe2	538924	5.02
a36e7402-c65c-4d34-84af-7533ac49bd3e	2976899	4.25
a74cd12e-6ea0-4b66-b112-538b8ebcc614	697526	3.67
a824f15a-b41d-4bb2-a6fe-7837a45505ce	1319301	3.67
a8f4beae-b2a2-49e7-aa9c-84bb5a73767c	7459179	5.02
a933e00b-978e-4932-a6f2-7d111ef821ee	8956168	2.99
ab06259e-dc40-4b4a-b505-2a84e581a51f	627577	5.02
ae2d8812-b142-4aa6-bfcd-a263f163baf4	2113766	3.67
ae7dbd2b-648e-4aad-87a1-a6ff5e03991d	1466335	4.25
b0e346d0-0f03-4ece-9150-df86cf82e735	482815	3.67
b532fa79-7f72-45ae-bf48-4515fb5ad2f5	926372	2.98
b5fba366-fe9c-4705-af35-315cf83ad3ad	402814	3.67
b8be20ef-5864-41c0-8fdc-2cd7102537e9	568484	5.02
b8c3e946-e0be-46e1-af6a-083b5f01f5d5	3872330	3.67
bd61d5c7-e909-4ddd-b1e4-9f7a69abd82c	1103029	3.67
c1bdfeec-daf1-436f-8c46-b97da697c0bb	133353	2.98
c1d948ac-638d-4016-a11f-666b6f9701ca	2882368	4.25
c4dfbfe5-dbfe-49cc-bb22-d1675094792e	163376	3.67
c61bb4f0-0737-4ffe-b7fe-7205f1484cbf	2307632	5.02
c72eaeac-fa92-4a22-b639-1e4574ab3d6d	762529	4.25
cddefc9f-97a3-4ddc-9337-6b1b91e013ac	847189	2.98
cfbd8786-97cb-4dd4-a587-07fe18b9d818	664307	3.67
d33094f5-6f57-4010-90d9-25d48ffc9ec6	7193435	4.25
dffeef33-405b-46f2-a8d3-752dbc292ef6	529943	3.67
e40bd7dc-ef67-447d-b455-a8702e22746a	58654	5.02
e47de289-b2ca-4089-9fcc-7df0c941065f	521034	4.25
e5737bc0-83e1-4b55-9e1e-177c94cffad4	596804	3.67
eb1fb731-0229-452f-a32d-64fc4808b2ef	5455837	3.67
ed062fcb-05c0-4dbe-87b3-f9650e1ad41a	637550	5.02
ed5a09ff-5524-4a87-8d23-161bacd28325	2986753	3.67
ede9663e-db5b-4b59-bc7d-6314c5305483	810473	3.67
f1ddcfd9-3b12-47bf-a07c-d3ffd6c99d1b	1185143	4.25
f39f0a39-57a6-4b9f-864b-c4d771c8b9a3	2205067	3.67
f859a009-e310-47a0-9255-5053cb652819	543959	2.98
fbd56fff-a09b-4637-b7e6-e236680013fa	647360	3.67
fd65e450-8454-49c9-a9a8-55dad0314417	1449906	2.98"""

# Load into DataFrame
df = pd.read_csv(StringIO(data_str), sep="\t")

# Set seed for reproducibility
np.random.seed(42)

# Generate past 7 days' prices with trend or randomness
def generate_past_prices(current_price):
    trend_type = np.random.choice(['upward', 'downward', 'random'])
    if trend_type == 'upward':
        end = current_price + np.random.uniform(0.5, 2.0)
        step = (end - current_price) / 7
        return [round(current_price + i * step + np.random.normal(0, 0.1), 2) for i in range(7)]
    elif trend_type == 'downward':
        end = max(0, current_price - np.random.uniform(0.5, 2.0))
        step = (current_price - end) / 7
        return [round(current_price - i * step + np.random.normal(0, 0.1), 2) for i in range(7)]
    else:
        return [round(np.clip(current_price + np.random.uniform(-2.0, 2.0), 0, None), 2) for _ in range(7)]

# Apply generation
past_prices = df['price'].apply(generate_past_prices)
past_df = pd.DataFrame(past_prices.tolist(), columns=[f'day_{i}_price' for i in range(1, 8)])

# Combine original with generated prices
full_df = pd.concat([df, past_df], axis=1)

# Show sample
print(full_df.head())

# Optionally, export to CSV
full_df.to_csv("trenddata.csv", index=False)
